# 区块链基础及应用

- **授课时间：** 2024FALL
- **授课教师：** 苏明

## 总体评价

首先这是一门专业选修课。回过头来看，实际上在大三上选择一门有期末考试的专业选修课，实际上是很不值的。因为OS编译计网三大门课程的期末压力已经足够大了，虽然说教务将区块链和密码学、习概放到了第一周考，一定程度上减轻了复习压力，但是实际上第二周的三大门还是很难顶的。如果在三大门的基础上再加上一门不太容易的D类课考试，我觉得是存在一定的压力的。单就课程来说，苏老师把一些区块链的基础知识都讲解的很到位，对于密码学和区块链感兴趣的同学可以选择这门课程，爆赞！

说到这了，顺便给出一下推荐的D类课修读策略。对于信安的同学来说，培养计划应该是15.5学分。这样的话，实际上在大二上选择信安前沿+python/java，大二下选择算法/嵌入式，大二暑期选择网安前沿，就可以凑到8学分。这样，实际上你还需要修读7.5学分，也就是说3门2.5学分的课程。对于大三上，回过头来看，实际上在开学时大家都在疯抢的一些D类课实际上成为了大三上的累赘。建议还是量力而行，对于想保出去的同学，在大三上选择一些给分不高的课程，获得一个中规中矩的分数是很不推荐的，因为夏令营看的是前五学期的成绩，并不看你修没修完D类课。所以大三上的策略实际上是保持自己的必修课的GPA！！！当然，如果你只想早点修完D类课大四开摆，那么在大三上修读1-2门d类课也是可以的。实际上大三下有很多的事少分高的d类课可以选择，没必要一定要在大三上修完。

对于大三上的d类课，实际上机器学习是比较推荐的，区块链的话可以尝试。实际上在绩点制的基础上，所有拿不到4.0的选修课，都尽量不要去选择，很拖GPA的。

## 得分情况

总体还行，不过看在这是一门D类课的份上，我觉得给分不是特别的乐观。高分（95+）不多，班上也有不少的低分（70+）。认真学还是能上90的，不过比例不多，主要是最后一题的压分，加上前面的一些判断题的细节，导致了频频的扣分，这样就拿不到很高的分数了。对于编程作业来说，由于助教没有公开大家的平时成绩，所以也不好说。对于纸质作业，尽量不要出错，每年的作业题都会更换，需要注意。

## 学习策略

课程的PPT较为晦涩难懂，上过老师的课应该就懂了。往年流传下来的复习笔记不多，本人针对PPT内容和老师上课所讲的写了一个复习笔记，在云盘中存放了，有需要的可以自取，链接在本人github主页。

由于该课程如果平时不听实验不做的话，期末会很痛苦，而且本年度实际上考察了很多有关实验的内容，所以我的建议是首先做好平时的实验作业，搞懂每一次实验的原理和实验代码，针对性的掌握一些课程中的伪代码（实际上一共只有两个伪代码），掌握老师布置的纸质作业，在此基础上，去刷一刷斯坦福的CS251中的题目，这样是最佳的复习策略了。

实际上苏老师的课程都是一样的，建议还是一定要在平时花功夫，要是想期末速通的话，很有可能考的你怀疑人生。

## 平时作业

一共是一次书面作业+六次上机作业，需要撰写实验报告。

- Ex0：配置bitcoin环境，领取测试币
- Ex1：分币操作
- Ex2：涉及四方的多签名交易
- Ex3：求解线性方程组谜题
- Ex4：跨链原子交换交易实验
- Ex5：去中心化应用程序(DAPP)
- Ex6：Tornado-zkSNARK
- homework1：本学期的纸质作业，均来自CS251课后练习题

## 考试内容

**仅回忆本年度（2024FALL）的考题**，之前2023FALL的回忆版在 ICU 都已经有学长提供了，在我的仓库中也有对应的文件。可以注意到苏老师每个年度出的题都完全不一致，所以千万不要试图对着往年题进行复习，仅供参考！！！

### 判断题(2分一个)

- 我们需要控制区块链挖矿难度不变，维持区块链的稳定性
- 不存在一个区块链的交易，其输入和输出都只有一个

- 给了一个区块链交易的具体代码，判断矿工挖出这个区块，所得的比特币是不是对应的数值

- 接上一题，判断脚本中第一行的hash是不是所有交易的hash
- 接上一题，这个交易已经有8个确认了，所以基本上不会被双花了
- 为了保证个人数据的安全性，可以将可证明安全写入到智能合约中

- 区块链中，交易费越高，就越容易得到共识

- 以太坊是图灵完备的，所以其编程语言支持所有类型的运算

- 蒙特币运用的技术是zn-shark

- 区块链的扫码支付和微信支付宝的原理不相同

### 填空题(5分一个)

- 比特币的市值为1万美金一个，求所有比特币的总价值
- 填写OP指令，填OP_EQUALVERIFY即可

```python
def P2PKH_scriptPubKey(address):
    
    script_address=address.to_scriptPubKey()   #script_address基于给定的bitcoin地址生成了一个脚本
    
    temp_hash_value=script_address[3:-2]   #提取出公钥哈希的值
    
    Script_PubKey = [
        OP_DUP,                   # 复制堆栈顶端数据
        OP_HASH160,               # 计算hash函数两次，第一次用SHA-256，第二次用RIPEMD-160
        temp_hash_value,          # 前面计算出来的公钥hash值
        OP_EQUALVERIFY,           # 检查栈顶两个元素是否相等，是一个bool值
        OP_CHECKSIG               # 检查栈顶元素是否是有效签名
    ]

    return Script_PubKey
```

### 解答题

- 求解线性方程组谜题，和实验是一样的代码，默写即可

- scrypt挖矿伪代码,bitcoin挖矿伪代码，scrypt相比bitcoin的优势

  - scrypt：

    ```python
    //ASIC mining code
    def scrypt(N,seed):
        V = [0] * N
        V[0] = seed
        for(i = 1 to N){
            V[i] = SHA256(V[i-1])//遍历求解
        }
        X=SHA256(V[N-1])//随机选的，就是为了进行检测
        for(i = 1 to N){
            j = X % N
            X = SHA256(X xor V[j])//计算hash值，然后再进行循环
        }
        return X
    ```

    CPU：

    ```c++
    //CPU mining code
    TARGET = (65535<<208)/DIFFICULTY;
    coinbase_nonce = 0;
    while(1){
        header = makeBlockHeader(transactions,coinbase_nonce);
        for(header_nonce=0;header_nonce<(1<<32);header_nonce++){
            if(SHA256(SHA256(makeBlock(header,header_nonce)))<TARGET){
                break;
            }
        }
        coinbase_nonce++;
    }
    ```

    优势：将算力集中转换到了内存集中，一定程度上保证了比特币的去中心化，让个人也可以挖出比特币

- 2/3密钥分存设计

- merkle树证明设计

  - 第一问是作业原题
  - 第二问，修改hash协议为hash(v,r)，r为随机值，为了保证v不被泄露，设计一个新的承诺和证明方案

- 跨链交易设计，就是Ex4的内容，和实验一模一样，简单设计一下就行了

- 难度题：2023年CS251 homework4第一题，在斯坦福的基础上去掉了hint，用于压分
